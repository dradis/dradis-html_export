<%= content_tag :div, id: 'plugin-html_export', class: 'tab-pane fade' do %>
  <%= form_tag project_export_manager_path(current_project), target: '_blank' do %>
    <%= hidden_field_tag :plugin, :html_export %>
    <%= hidden_field_tag :route, :root %>

    <h4 class="header-underline">Choose a template</h4>
    <p>Please choose one of the templates available for this plugin (find them in <code>.<%= Dradis::Plugins::HtmlExport::TemplatePresenter.templates_dir[Rails.root.to_s.length..-1] %></code>)</p>

    <% Dradis::Plugins::HtmlExport::TemplatePresenter.each_template do |template| %>
      <% present(template, Dradis::Plugins::HtmlExport::TemplatePresenter) do |template_presenter| %>
        <div class="custom-control custom-radio">
          <%= radio_button_tag :template, template_presenter.filename, Dradis::Plugins::HtmlExport::TemplatePresenter.templates.first == template , class: 'custom-control-input' %>
          <label class="custom-control-label" for="template_<%= template_presenter.filename %>">
            <%= template_presenter.title %>
          </label>
        </div>
      <% end %>
    <% end %>

    <div class="btn-group btn-states mt-4" data-behavior="btn-states">
      <button id="export-button" class="btn btn-lg btn-primary">Export <span data-behavior="state-button">Published</span> Records</button>
      <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <span class="sr-only">Toggle Dropdown</span>
      </button>
      <div class="dropdown-menu">
        <%= collection_radio_buttons(:html_export, :scope, [['published', 'published'], ['all', 'all']], :first, :first) do |b| %>
          <span>
            <%= b.label class: 'state' do %>
              <%= b.radio_button class: 'd-none', data: { behavior: 'state-radio'}, checked: b.value == 'published' %>
              <i class="fa fa-check fa-fw"></i>
              <div class="state-label">
                <p data-behavior="state-label"><%= b.text.humanize %></p>
                <% case b.value %>
                <% when 'published' %>
                <span>Only records that have been reviewed and published.</span>
                <% when 'all' %>
                <span>All records, regardless if they are draft, ready for review, or published.</span>
                <% end %>
              </div>
            <% end %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>
<% end%>
